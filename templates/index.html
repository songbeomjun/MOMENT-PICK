<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOMENT PICK</title>

  <!-- íŒŒë¹„ì½˜ -->
  <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">

  <!-- OG / SNS ë¯¸ë¦¬ë³´ê¸° -->
  <meta property="og:title" content="MOMENT PICK">
  <meta property="og:description" content="ì˜¤ëŠ˜ì˜ ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ â€” ë§¤ì¼ ë¯¸ì…˜ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì±„ì›Œë³´ì„¸ìš”">
  <meta property="og:image" content="/static/og-image.png">
  <meta property="og:type" content="website">

  <!-- íŠ¸ìœ„í„° ì¹´ë“œ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MOMENT PICK">
  <meta name="twitter:description" content="ì˜¤ëŠ˜ì˜ ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ â€” ë§¤ì¼ ë¯¸ì…˜ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì±„ì›Œë³´ì„¸ìš”">
  <meta name="twitter:image" content="/static/og-image.png">

  <!-- ê²€ìƒ‰ì—”ì§„ -->
  <meta name="description" content="ì˜¤ëŠ˜ì˜ ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ â€” ë§¤ì¼ ë¯¸ì…˜ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì±„ì›Œë³´ì„¸ìš”">
  <meta name="theme-color" content="#c9a84c">

  <!-- PWA -->
  <link rel="manifest" href="/static/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ëª¨ë¨¼íŠ¸í”½">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #13131c;
    --surface2: #1c1c2a;
    --gold: #c9a84c;
    --gold-light: #e8c97a;
    --gold-dim: rgba(201,168,76,0.15);
    --text: #f0ead8;
    --text-muted: #8a8272;
    --accent: #7b6cd4;
    --success: #4caf82;
    --border: rgba(201,168,76,0.2);
  }
  body.light {
    --bg: #f7f3ec;
    --surface: #ffffff;
    --surface2: #ede8de;
    --gold: #b8922a;
    --gold-light: #c9a84c;
    --gold-dim: rgba(184,146,42,0.12);
    --text: #1a1612;
    --text-muted: #7a6e5f;
    --accent: #5c4eb8;
    --success: #2e8a5c;
    --border: rgba(184,146,42,0.25);
  }
  body.light::before { background: radial-gradient(ellipse, rgba(201,168,76,0.08) 0%, transparent 70%); }
  body.light::after  { background: radial-gradient(ellipse, rgba(123,108,212,0.06) 0%, transparent 70%); }
  .theme-toggle {
    position: fixed; top: 16px; right: 16px; z-index: 999;
    width: 44px; height: 44px; border-radius: 50%;
    border: 1.5px solid var(--border); background: var(--surface);
    cursor: pointer; font-size: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: background .3s, border-color .3s, transform .2s;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  }
  .theme-toggle:hover { transform: scale(1.1); border-color: var(--gold); }
  .bgm-toggle {
    position: fixed; top: 68px; right: 16px; z-index: 999;
    width: 44px; height: 44px; border-radius: 50%;
    border: 1.5px solid var(--border); background: var(--surface);
    cursor: pointer; font-size: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: background .3s, border-color .3s, transform .2s;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  }
  .bgm-toggle:hover { transform: scale(1.1); border-color: var(--gold); }
  .cal-toggle {
    position: fixed; top: 120px; right: 16px; z-index: 999;
    width: 44px; height: 44px; border-radius: 50%;
    border: 1.5px solid var(--border); background: var(--surface);
    cursor: pointer; font-size: 20px;
    display: flex; align-items: center; justify-content: center;
    transition: background .3s, border-color .3s, transform .2s;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  }
  .cal-toggle:hover { transform: scale(1.1); border-color: var(--gold); }

  /* ìº˜ë¦°ë” ëª¨ë‹¬ */
  .cal-modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.7);
    display: none; align-items: center; justify-content: center;
    z-index: 1000; padding: 20px;
  }
  .cal-modal-overlay.show { display: flex; }
  .cal-modal {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 28px; width: 100%; max-width: 380px;
    max-height: 80vh; overflow-y: auto;
  }
  .cal-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 20px;
  }
  .cal-header h2 { font-size: 18px; color: var(--gold-light); }
  .cal-nav { display: flex; align-items: center; gap: 12px; }
  .cal-nav button {
    background: none; border: 1px solid var(--border); border-radius: 8px;
    color: var(--text); cursor: pointer; padding: 4px 10px; font-size: 14px;
    transition: border-color .2s;
  }
  .cal-nav button:hover { border-color: var(--gold); color: var(--gold); }
  .cal-nav span { font-size: 14px; color: var(--gold); font-weight: 700; min-width: 80px; text-align: center; }
  .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 16px; }
  .cal-day-label { text-align: center; font-size: 10px; color: var(--text-muted); padding: 4px 0; }
  .cal-day {
    aspect-ratio: 1; border-radius: 8px; display: flex; flex-direction: column;
    align-items: center; justify-content: center; font-size: 12px;
    cursor: pointer; transition: background .15s; position: relative;
    color: var(--text-muted);
  }
  .cal-day.today { border: 1.5px solid var(--gold); color: var(--gold); font-weight: 700; }
  .cal-day.has-record { background: var(--gold-dim); color: var(--text); }
  .cal-day.has-record::after {
    content: 'âœ¦'; position: absolute; bottom: 2px; font-size: 7px; color: var(--gold);
  }
  .cal-day:hover { background: var(--surface2); }
  .cal-day.empty { cursor: default; }
  .cal-record { margin-top: 12px; padding: 14px; background: var(--surface2); border-radius: 12px; }
  .cal-record h3 { font-size: 13px; color: var(--gold); margin-bottom: 8px; }
  .cal-record-item { font-size: 12px; color: var(--text-muted); padding: 4px 0; border-bottom: 1px solid var(--border); }
  .cal-record-item:last-child { border-bottom: none; }
  .cal-close { margin-top: 16px; width: 100%; padding: 12px; background: var(--gold-dim); border: 1px solid var(--border); border-radius: 10px; color: var(--gold); font-size: 14px; cursor: pointer; transition: background .2s; }
  .cal-close:hover { background: rgba(201,168,76,0.25); }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Noto Sans KR', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    top: -20%; left: -20%;
    width: 60%; height: 60%;
    background: radial-gradient(ellipse, rgba(201,168,76,0.06) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }
  body::after {
    content: '';
    position: fixed;
    bottom: -20%; right: -20%;
    width: 60%; height: 60%;
    background: radial-gradient(ellipse, rgba(123,108,212,0.07) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }
  header {
    width: 100%; max-width: 480px;
    padding: 48px 24px 24px;
    position: relative; z-index: 1; text-align: center;
  }
  .logo-subtitle { font-size: 10px; letter-spacing: 6px; color: var(--gold); text-transform: uppercase; margin-bottom: 8px; opacity: .8; }
  .logo { font-family: 'Playfair Display', serif; font-size: 38px; font-weight: 900; letter-spacing: 2px; color: var(--text); line-height: 1; }
  .logo span { color: var(--gold); }
  .logo-tagline { font-size: 11px; letter-spacing: 3px; color: var(--text-muted); margin-top: 8px; text-transform: uppercase; }
  .date-badge { display: inline-flex; align-items: center; gap: 6px; background: var(--gold-dim); border: 1px solid var(--border); border-radius: 20px; padding: 6px 16px; font-size: 12px; color: var(--gold-light); margin-top: 20px; }
  .container { width: 100%; max-width: 480px; padding: 16px 20px; position: relative; z-index: 1; flex: 1; }

  /* Progress */
  .progress-section { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 20px; margin-bottom: 20px; }
  .progress-label { display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted); margin-bottom: 10px; }
  .progress-label span:last-child { color: var(--gold); font-weight: 700; }
  .progress-bar { height: 6px; background: var(--surface2); border-radius: 3px; overflow: hidden; }
  .progress-fill { height: 100%; background: linear-gradient(90deg, var(--gold), var(--gold-light)); border-radius: 3px; transition: width .6s cubic-bezier(.4,0,.2,1); }

  /* Timer */
  .timer-section { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; padding: 20px 24px; margin-bottom: 20px; text-align: center; }
  .timer-label { font-size: 11px; letter-spacing: 4px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 14px; }
  .timer-display { font-family: 'Playfair Display', serif; font-size: 52px; font-weight: 700; color: var(--gold-light); letter-spacing: 4px; line-height: 1; margin-bottom: 6px; transition: color .3s; }
  .timer-display.done { color: var(--success); }
  .timer-display.paused { color: var(--text-muted); }
  .timer-ring { display: flex; justify-content: center; margin-bottom: 16px; }
  .timer-ring svg { transform: rotate(-90deg); }
  .timer-ring circle.bg { fill: none; stroke: var(--surface2); stroke-width: 4; }
  .timer-ring circle.progress { fill: none; stroke: var(--gold); stroke-width: 4; stroke-linecap: round; stroke-dasharray: 220; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear, stroke .3s; }
  .timer-ring circle.progress.done { stroke: var(--success); }
  .timer-buttons { display: flex; gap: 10px; justify-content: center; }
  .btn-timer { padding: 10px 22px; border-radius: 10px; font-family: 'Noto Sans KR', sans-serif; font-size: 13px; font-weight: 600; cursor: pointer; border: 1px solid var(--border); transition: background .2s, color .2s, border-color .2s; }
  .btn-timer-start { background: linear-gradient(135deg, var(--gold), var(--gold-light)); color: #0a0a0f; border-color: transparent; }
  .btn-timer-start:hover { opacity: .88; }
  .btn-timer-pause { background: transparent; color: var(--text-muted); border-color: var(--border); }
  .btn-timer-pause:hover { border-color: var(--gold); color: var(--gold); }
  .btn-timer-reset { background: transparent; color: var(--text-muted); border-color: var(--border); }
  .btn-timer-reset:hover { border-color: rgba(201,168,76,.4); color: var(--text); }

  /* Pick section */
  .pick-section { background: var(--surface); border: 1px solid var(--border); border-radius: 20px; padding: 24px; text-align: center; margin-bottom: 20px; }
  .pick-section h3 { font-family: 'Playfair Display', serif; font-size: 20px; color: var(--gold-light); margin-bottom: 6px; }
  .pick-section p { font-size: 13px; color: var(--text-muted); margin-bottom: 20px; }
  .btn-pick { padding: 16px 40px; background: linear-gradient(135deg, #7b6cd4, #a899e8); color: white; border: none; border-radius: 14px; font-family: 'Noto Sans KR', sans-serif; font-size: 15px; font-weight: 700; cursor: pointer; letter-spacing: 2px; transition: transform .2s, box-shadow .2s; box-shadow: 0 4px 20px rgba(123,108,212,.3); }
  .btn-pick:hover { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(123,108,212,.4); }
  .btn-pick:active { transform: scale(.97); }

  /* Section title */
  .section-title { font-size: 11px; letter-spacing: 4px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 14px; padding-left: 4px; }

  /* Mission cards */
  .missions { display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px; }
  .mission-card { background: var(--surface); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; transition: border-color .2s, box-shadow .2s; }
  .mission-card:hover { border-color: var(--gold); box-shadow: 0 0 20px rgba(201,168,76,.1); }
  .mission-card.active { border-color: var(--gold); box-shadow: 0 0 24px rgba(201,168,76,.15); }
  .mission-card.completed { border-color: var(--success); opacity: .8; }
  .mission-header { display: flex; align-items: center; gap: 14px; padding: 18px 20px; cursor: pointer; user-select: none; }
  .mission-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; flex-shrink: 0; background: var(--surface2); border: 1px solid var(--border); transition: transform .2s; }
  .mission-card.active .mission-icon, .mission-card:hover .mission-icon { transform: scale(1.1); }
  .mission-card.completed .mission-icon { background: rgba(76,175,130,.1); border-color: var(--success); }
  .mission-info { flex: 1; }
  .mission-name { font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 4px; }
  .mission-desc { font-size: 12px; color: var(--text-muted); line-height: 1.5; }
  .mission-status { font-size: 11px; font-weight: 500; padding: 4px 10px; border-radius: 8px; flex-shrink: 0; }
  .status-pending { background: var(--gold-dim); color: var(--gold); }
  .status-active { background: rgba(123,108,212,.2); color: #a899e8; }
  .status-done { background: rgba(76,175,130,.15); color: var(--success); }
  .mission-expand { display: none; padding: 0 20px 20px; animation: slideDown .25s ease; }
  .mission-expand.show { display: block; }
  @keyframes slideDown { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
  .expand-divider { height: 1px; background: var(--border); margin-bottom: 16px; }
  .mission-textarea { width: 100%; background: var(--surface2); border: 1px solid var(--border); border-radius: 12px; padding: 14px 16px; color: var(--text); font-family: 'Noto Sans KR', sans-serif; font-size: 14px; line-height: 1.7; resize: none; min-height: 100px; transition: border-color .2s; outline: none; }
  .mission-textarea:focus { border-color: var(--gold); }
  .mission-textarea::placeholder { color: var(--text-muted); }
  .char-count { text-align: right; font-size: 11px; color: var(--text-muted); margin-top: 6px; margin-bottom: 12px; }
  .btn-complete { width: 100%; padding: 14px; background: linear-gradient(135deg, var(--gold), var(--gold-light)); color: #0a0a0f; border: none; border-radius: 12px; font-family: 'Noto Sans KR', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; letter-spacing: 1px; transition: opacity .2s, transform .1s; display: flex; align-items: center; justify-content: center; gap: 8px; }
  .btn-complete:hover { opacity: .9; }
  .btn-complete:active { transform: scale(.98); }
  .photo-upload-area { border: 2px dashed var(--border); border-radius: 12px; padding: 28px; text-align: center; cursor: pointer; transition: border-color .2s, background .2s; margin-bottom: 12px; }
  .photo-upload-area:hover { border-color: var(--gold); background: var(--gold-dim); }
  .photo-upload-area.has-file { border-color: var(--success); border-style: solid; }
  .upload-icon { font-size: 28px; margin-bottom: 8px; }
  .upload-text { font-size: 13px; color: var(--text-muted); }
  .upload-hint { font-size: 11px; color: var(--text-muted); margin-top: 4px; opacity: .6; }
  .action-card { background: var(--surface2); border-radius: 12px; padding: 20px; text-align: center; margin-bottom: 12px; }
  .action-card p { font-size: 13px; color: var(--text-muted); margin-bottom: 16px; }
  .btn-action { padding: 12px 28px; background: transparent; border: 1px solid var(--gold); color: var(--gold); border-radius: 10px; font-family: 'Noto Sans KR', sans-serif; font-size: 13px; font-weight: 600; cursor: pointer; transition: background .2s, color .2s; }
  .btn-action:hover { background: var(--gold); color: #0a0a0f; }
  .result-box { background: var(--gold-dim); border: 1px solid var(--border); border-radius: 10px; padding: 14px; font-size: 14px; color: var(--gold-light); margin-top: 12px; display: none; animation: fadeIn .3s ease; }
  .result-box.show { display: block; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

  /* Add buttons */
  .add-buttons-row { display: flex; gap: 10px; margin-bottom: 24px; }
  .btn-add-mission { flex: 1; padding: 14px 12px; background: transparent; border: 2px dashed var(--border); border-radius: 16px; color: var(--text-muted); font-family: 'Noto Sans KR', sans-serif; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 7px; transition: border-color .2s, color .2s, background .2s; letter-spacing: .5px; line-height: 1.4; text-align: center; }
  .btn-add-manual:hover { border-color: var(--gold); color: var(--gold); background: var(--gold-dim); }
  .btn-add-auto { border-color: rgba(123,108,212,.3); color: #a899e8; }
  .btn-add-auto:hover { border-color: var(--accent); color: var(--accent); background: rgba(123,108,212,.1); }
  .btn-add-plus { font-size: 16px; line-height: 1; }
  .btn-add-auto.loading { opacity: .6; cursor: not-allowed; animation: pulse 1s ease-in-out infinite; }
  @keyframes pulse { 0%, 100% { opacity: .6; } 50% { opacity: .3; } }

  /* Completed glow */
  @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
  .completed-glow { background: linear-gradient(90deg, var(--success), #7de8b5, var(--success)); background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shimmer 2s linear infinite; }

  /* Toast */
  .toast { position: fixed; bottom: 32px; left: 50%; transform: translateX(-50%) translateY(80px); background: var(--success); color: white; padding: 12px 24px; border-radius: 50px; font-size: 14px; font-weight: 600; z-index: 999; transition: transform .35s cubic-bezier(.4,0,.2,1); white-space: nowrap; box-shadow: 0 8px 24px rgba(76,175,130,.4); }
  .toast.show { transform: translateX(-50%) translateY(0); }

  /* Modal */
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.7); backdrop-filter: blur(4px); z-index: 100; display: flex; align-items: center; justify-content: center; padding: 20px; opacity: 0; pointer-events: none; transition: opacity .3s; }
  .modal-overlay.show { opacity: 1; pointer-events: all; }
  .modal { background: var(--surface); border: 1px solid var(--gold); border-radius: 24px; padding: 32px 28px; max-width: 380px; width: 100%; text-align: center; transform: scale(.9); transition: transform .3s; }
  .modal-overlay.show .modal { transform: scale(1); }
  .modal-icon { font-size: 48px; margin-bottom: 16px; }
  .modal h2 { font-family: 'Playfair Display', serif; font-size: 24px; color: var(--gold-light); margin-bottom: 10px; }
  .modal p { font-size: 14px; color: var(--text-muted); line-height: 1.6; margin-bottom: 24px; }
  .btn-modal { padding: 14px 32px; background: linear-gradient(135deg, var(--gold), var(--gold-light)); color: #0a0a0f; border: none; border-radius: 12px; font-family: 'Noto Sans KR', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; transition: opacity .2s; }
  .btn-modal:hover { opacity: .85; }

  /* Add mission modal */
  .add-modal { background: var(--surface); border: 1px solid var(--gold); border-radius: 24px; padding: 28px 24px; max-width: 420px; width: 100%; transform: scale(.9); transition: transform .3s; max-height: 90vh; overflow-y: auto; }
  .modal-overlay.show .add-modal { transform: scale(1); }
  .add-modal h2 { font-family: 'Playfair Display', serif; font-size: 22px; color: var(--gold-light); margin-bottom: 20px; text-align: center; }
  .add-field { margin-bottom: 14px; }
  .add-field label { display: block; font-size: 11px; letter-spacing: 3px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 8px; }
  .add-field input, .add-field textarea, .add-field select { width: 100%; background: var(--surface2); border: 1px solid var(--border); border-radius: 10px; padding: 12px 14px; color: var(--text); font-family: 'Noto Sans KR', sans-serif; font-size: 14px; outline: none; transition: border-color .2s; }
  .add-field input:focus, .add-field textarea:focus, .add-field select:focus { border-color: var(--gold); }
  .add-field textarea { resize: none; min-height: 70px; line-height: 1.6; }
  .add-field select option { background: var(--surface2); }
  .icon-picker { display: flex; flex-wrap: wrap; gap: 8px; }
  .icon-option { width: 40px; height: 40px; border-radius: 10px; border: 1px solid var(--border); background: var(--surface2); font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: border-color .15s, background .15s; }
  .icon-option:hover { border-color: var(--gold); background: var(--gold-dim); }
  .icon-option.selected { border-color: var(--gold); background: var(--gold-dim); box-shadow: 0 0 8px rgba(201,168,76,.3); }
  .add-modal-buttons { display: flex; gap: 10px; margin-top: 20px; }
  .btn-add-cancel { flex: 1; padding: 13px; background: transparent; border: 1px solid var(--border); border-radius: 10px; color: var(--text-muted); font-family: 'Noto Sans KR', sans-serif; font-size: 14px; font-weight: 600; cursor: pointer; transition: border-color .2s, color .2s; }
  .btn-add-cancel:hover { border-color: var(--gold); color: var(--text); }
  .btn-add-confirm { flex: 2; padding: 13px; background: linear-gradient(135deg, var(--gold), var(--gold-light)); border: none; border-radius: 10px; color: #0a0a0f; font-family: 'Noto Sans KR', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; transition: opacity .2s; letter-spacing: 1px; }
  .btn-add-confirm:hover { opacity: .88; }

  footer { width: 100%; max-width: 480px; text-align: center; padding: 24px; font-size: 11px; color: var(--text-muted); opacity: .5; position: relative; z-index: 1; letter-spacing: 2px; }
</style>
</head>
<body>

<button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="í…Œë§ˆ ë³€ê²½">ğŸŒ™</button>
<button class="bgm-toggle" id="bgmToggle" onclick="toggleBGM()" title="ë°°ê²½ìŒì•…">ğŸ”‡</button>
<button class="cal-toggle" id="calToggle" onclick="openCalendar()" title="ìº˜ë¦°ë”">ğŸ“…</button>

<header>
  <div class="logo-subtitle">âœ¦ Daily Mission App âœ¦</div>
  <div class="logo">MOMENT <span>PICK</span></div>
  <div class="logo-tagline">ì˜¤ëŠ˜ì˜ ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ</div>
  <div class="date-badge">ğŸ“… {{ today }}</div>
</header>

<div class="container">

  <div class="progress-section">
    <div class="progress-label">
      <span>ì˜¤ëŠ˜ì˜ ë‹¬ì„±ë¥ </span>
      <span id="progressText">0 / 0</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill" style="width:0%"></div>
    </div>
  </div>

  <div class="timer-section">
    <div class="timer-label">â± 5ë¶„ ì§‘ì¤‘ íƒ€ì´ë¨¸</div>
    <div class="timer-ring">
      <svg width="80" height="80" viewBox="0 0 80 80">
        <circle class="bg" cx="40" cy="40" r="35"/>
        <circle class="progress" id="timerRing" cx="40" cy="40" r="35"/>
      </svg>
    </div>
    <div class="timer-display" id="timerDisplay">05:00</div>
    <div class="timer-buttons">
      <button class="btn-timer btn-timer-start" id="btnStart" onclick="timerStart()">â–¶ ì‹œì‘</button>
      <button class="btn-timer btn-timer-pause" id="btnPause" onclick="timerPause()" style="display:none">â¸ ì¼ì‹œì •ì§€</button>
      <button class="btn-timer btn-timer-reset" onclick="timerReset()">â†º ì´ˆê¸°í™”</button>
    </div>
  </div>

  <div class="pick-section">
    <h3>âœ¨ ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ PICK</h3>
    <p>ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜¤ëŠ˜ì˜ íŠ¹ë³„í•œ ë¯¸ì…˜ì„ ì‹œì‘í•˜ì„¸ìš”</p>
    <button class="btn-pick" onclick="pickMoment()">âœ¦ PICK MY MOMENT</button>
  </div>

  <div class="section-title">â–¸ ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ ëª©ë¡</div>
  <div class="missions" id="missionList"></div>

  <div class="add-buttons-row">
    <button class="btn-add-mission btn-add-manual" onclick="openAddModal()">
      <span class="btn-add-plus">âœï¸</span> ì§ì ‘ ë¯¸ì…˜ ì¶”ê°€í•˜ê¸°
    </button>
    <button class="btn-add-mission btn-add-auto" id="btnAutoAdd" onclick="autoAddMission()">
      <span class="btn-add-plus">âœ¨</span> ìë™ ë¯¸ì…˜ ìƒì„±í•˜ê¸°
    </button>
  </div>

</div>

<div class="toast" id="toast"></div>

<!-- Completion Modal -->
<div class="modal-overlay" id="completionModal">
  <div class="modal">
    <div class="modal-icon">ğŸ†</div>
    <h2>ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ!</h2>
    <p>ì˜¤ëŠ˜ì˜ ëª¨ë“  ìˆœê°„ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“¤ì—ˆì–´ìš”.<br>ë‚´ì¼ë„ í•¨ê»˜í•´ìš” âœ¨</p>
    <button class="btn-modal" onclick="closeModal()">ë‹«ê¸°</button>
  </div>
</div>

<!-- Add Mission Modal -->
<div class="modal-overlay" id="addMissionModal">
  <div class="add-modal">
    <h2>âœ¦ ì§ì ‘ ë¯¸ì…˜ ì¶”ê°€</h2>
    <div class="add-field">
      <label>ë¯¸ì…˜ ì´ë¦„</label>
      <input type="text" id="newMissionName" placeholder="ì˜ˆ) ì˜¤ëŠ˜ í•˜ë£¨ ì¼ê¸° ì“°ê¸°" maxlength="30">
    </div>
    <div class="add-field">
      <label>ì„¤ëª… (ì„ íƒ)</label>
      <textarea id="newMissionDesc" placeholder="ë¯¸ì…˜ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”..." maxlength="80"></textarea>
    </div>
    <div class="add-field">
      <label>ë¯¸ì…˜ ìœ í˜•</label>
      <select id="newMissionType" onchange="togglePlaceholderField(this.value)">
        <option value="text">âœï¸ í…ìŠ¤íŠ¸ ì‘ì„±</option>
        <option value="photo">ğŸ“¸ ì‚¬ì§„ ì—…ë¡œë“œ</option>
        <option value="random">ğŸ² ëœë¤ ë½‘ê¸°</option>
        <option value="check">âœ… ë‹¨ìˆœ ì²´í¬</option>
      </select>
    </div>
    <div class="add-field" id="placeholderField">
      <label>ì…ë ¥ì°½ ì•ˆë‚´ë¬¸êµ¬ (ì„ íƒ)</label>
      <input type="text" id="newMissionPlaceholder" placeholder="ì˜ˆ) ì˜¤ëŠ˜ ìˆì—ˆë˜ ì¼ì„ ììœ ë¡­ê²Œ ì¨ë³´ì„¸ìš”...">
    </div>
    <div class="add-field">
      <label>ì•„ì´ì½˜ ì„ íƒ</label>
      <div class="icon-picker" id="iconPicker"></div>
    </div>
    <div class="add-modal-buttons">
      <button class="btn-add-cancel" onclick="closeAddModal()">ì·¨ì†Œ</button>
      <button class="btn-add-confirm" onclick="confirmAddMission()">âœ¦ ë¯¸ì…˜ ì¶”ê°€</button>
    </div>
  </div>
</div>

<!-- Calendar Modal -->
<div class="cal-modal-overlay" id="calModal">
  <div class="cal-modal">
    <div class="cal-header">
      <h2>ğŸ“… ë¯¸ì…˜ ìº˜ë¦°ë”</h2>
      <div class="cal-nav">
        <button onclick="calPrevMonth()">â€¹</button>
        <span id="calMonthLabel"></span>
        <button onclick="calNextMonth()">â€º</button>
      </div>
    </div>
    <div class="cal-grid" id="calGrid"></div>
    <div class="cal-record" id="calRecord" style="display:none"></div>
    <button class="cal-close" onclick="closeCalendar()">ë‹«ê¸°</button>
  </div>
</div>

<footer>MOMENT PICK Â© 2026</footer>

<script>
// ì„œë²„ì—ì„œ ë°›ì€ ì´ˆê¸° ë°ì´í„°
let MISSIONS = {{ missions | tojson }};
let state = {{ state | tojson }};

// â”€â”€ ì§„í–‰ë¥  â”€â”€
function getCompletedCount() {
  return MISSIONS.filter(m => state[String(m.id)] && state[String(m.id)].completed).length;
}

function updateProgress() {
  const count = getCompletedCount();
  const total = MISSIONS.length;
  document.getElementById('progressText').textContent = `${count} / ${total}`;
  document.getElementById('progressFill').style.width = total > 0 ? `${(count/total)*100}%` : '0%';
  if (total > 0 && count === total) {
    setTimeout(() => document.getElementById('completionModal').classList.add('show'), 600);
  }
}

// â”€â”€ í† ìŠ¤íŠ¸ â”€â”€
function showToast(msg, color) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.background = color || 'var(--success)';
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

// â”€â”€ ë¯¸ì…˜ í† ê¸€ â”€â”€
function toggleMission(id) {
  if (state[String(id)] && state[String(id)].completed) return;
  MISSIONS.forEach(m => {
    if (m.id !== id && state[String(m.id)]) state[String(m.id)].expanded = false;
  });
  if (!state[String(id)]) state[String(id)] = { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
  state[String(id)].expanded = !state[String(id)].expanded;
  renderMissions();
}

// â”€â”€ ë¯¸ì…˜ ì™„ë£Œ â”€â”€
async function completeMission(id) {
  const m = MISSIONS.find(x => x.id === id);
  const s = state[String(id)];
  let value = '', fileName = '', lucky = null;

  if (m.type === 'text') {
    const ta = document.getElementById(`textarea-${id}`);
    value = ta ? ta.value.trim() : '';
    if (value.length < (m.minLength || 5)) {
      showToast(`ìµœì†Œ ${m.minLength || 5}ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš” âœï¸`, '#c97b4c');
      return;
    }
  } else if (m.type === 'photo') {
    fileName = s.fileName || '';
    if (!fileName) {
      showToast('ì‚¬ì§„ì„ ì„ íƒí•´ì£¼ì„¸ìš” ğŸ“¸', '#c97b4c');
      return;
    }
  } else if (m.type === 'random') {
    lucky = s.lucky;
    if (!lucky) {
      showToast('í–‰ìš´ ë²ˆí˜¸ë¥¼ ë¨¼ì € ë½‘ì•„ì£¼ì„¸ìš” ğŸ²', '#c97b4c');
      return;
    }
  }

  const res = await fetch('/api/complete', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ id, value, fileName, lucky })
  });
  const data = await res.json();
  if (data.success) {
    state[String(id)].completed = true;
    state[String(id)].expanded = false;
    showToast(`"${m.name}" ì™„ë£Œ! ğŸ‰`);
    updateProgress();
    renderMissions();
  }
}

// â”€â”€ í–‰ìš´ ë²ˆí˜¸ â”€â”€
async function pickRandom(id) {
  const res = await fetch('/api/lucky', { method: 'POST' });
  const data = await res.json();
  state[String(id)].lucky = data.number;
  const box = document.getElementById(`lucky-${id}`);
  if (box) { box.textContent = `ğŸ‰ ì˜¤ëŠ˜ì˜ í–‰ìš´ ë²ˆí˜¸: ${data.number}`; box.classList.add('show'); }
}

// â”€â”€ íŒŒì¼ ì„ íƒ â”€â”€
function handleFileChange(id, input) {
  if (input.files && input.files[0]) {
    state[String(id)].fileName = input.files[0].name;
    const area = document.getElementById(`upload-${id}`);
    area.classList.add('has-file');
    area.querySelector('.upload-text').textContent = `âœ… ${input.files[0].name}`;
    area.querySelector('.upload-hint').textContent = 'ë‹¤ë¥¸ ì‚¬ì§„ ì„ íƒí•˜ë ¤ë©´ í´ë¦­';
  }
}

// â”€â”€ ëœë¤ PICK â”€â”€
function pickMoment() {
  const pending = MISSIONS.filter(m => !state[String(m.id)]?.completed);
  if (pending.length === 0) { showToast('ì˜¤ëŠ˜ ëª¨ë“  ë¯¸ì…˜ì„ ì™„ë£Œí–ˆì–´ìš”! ğŸ‰'); return; }
  const pick = pending[Math.floor(Math.random() * pending.length)];
  MISSIONS.forEach(m => { if (!state[String(m.id)]?.completed && state[String(m.id)]) state[String(m.id)].expanded = false; });
  state[String(pick.id)].expanded = true;
  renderMissions();
  setTimeout(() => {
    const cards = document.querySelectorAll('.mission-card');
    const idx = MISSIONS.findIndex(m => m.id === pick.id);
    if (cards[idx]) cards[idx].scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 100);
  showToast(`"${pick.name}" ë¯¸ì…˜ì´ ì„ íƒëì–´ìš”! âœ¨`, '#7b6cd4');
}

// â”€â”€ ë Œë”ë§ â”€â”€
function renderMissions() {
  const container = document.getElementById('missionList');
  container.innerHTML = '';
  MISSIONS.forEach(m => {
    const s = state[String(m.id)] || { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
    const card = document.createElement('div');
    card.className = `mission-card${s.expanded ? ' active' : ''}${s.completed ? ' completed' : ''}`;

    const statusLabel = s.completed ? 'ì™„ë£Œ' : s.expanded ? 'ì§„í–‰ì¤‘' : 'ëŒ€ê¸°';
    const statusClass = s.completed ? 'status-done' : s.expanded ? 'status-active' : 'status-pending';
    const nameHtml = s.completed ? `<span class="completed-glow">${m.name}</span>` : m.name;

    let expandContent = '';
    if (s.expanded && !s.completed) {
      if (m.type === 'text') {
        expandContent = `
          <div class="expand-divider"></div>
          <textarea class="mission-textarea" id="textarea-${m.id}" placeholder="${m.placeholder || ''}" maxlength="500" oninput="updateChar(${m.id})">${s.value || ''}</textarea>
          <div class="char-count"><span id="char-${m.id}">${(s.value||'').length}</span> / 500</div>
          <button class="btn-complete" onclick="completeMission(${m.id})">âœ¦ ë¯¸ì…˜ ì™„ë£Œ</button>`;
      } else if (m.type === 'photo') {
        expandContent = `
          <div class="expand-divider"></div>
          <div class="photo-upload-area${s.fileName ? ' has-file' : ''}" id="upload-${m.id}" onclick="document.getElementById('photo-${m.id}').click()">
            <div class="upload-icon">ğŸ“·</div>
            <div class="upload-text">${s.fileName || 'ì‚¬ì§„ì„ ì„ íƒí•˜ë ¤ë©´ í´ë¦­í•˜ì„¸ìš”'}</div>
            <div class="upload-hint">${s.fileName ? 'ë‹¤ë¥¸ ì‚¬ì§„ ì„ íƒí•˜ë ¤ë©´ í´ë¦­' : 'JPG, PNG, HEIC ì§€ì›'}</div>
          </div>
          <input type="file" id="photo-${m.id}" accept="image/*" style="display:none" onchange="handleFileChange(${m.id}, this)">
          <button class="btn-complete" onclick="completeMission(${m.id})">âœ¦ ë¯¸ì…˜ ì™„ë£Œ</button>`;
      } else if (m.type === 'random') {
        expandContent = `
          <div class="expand-divider"></div>
          <div class="action-card">
            <p>ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜¤ëŠ˜ì˜ í–‰ìš´ ë²ˆí˜¸ë¥¼ ë½‘ì•„ë³´ì„¸ìš”!</p>
            <button class="btn-action" onclick="pickRandom(${m.id})">ğŸ² ë²ˆí˜¸ ë½‘ê¸°</button>
            <div class="result-box${s.lucky ? ' show' : ''}" id="lucky-${m.id}">${s.lucky ? `ğŸ‰ ì˜¤ëŠ˜ì˜ í–‰ìš´ ë²ˆí˜¸: ${s.lucky}` : ''}</div>
          </div>
          <button class="btn-complete" onclick="completeMission(${m.id})">âœ¦ ë¯¸ì…˜ ì™„ë£Œ</button>`;
      } else if (m.type === 'check') {
        expandContent = `
          <div class="expand-divider"></div>
          <div class="action-card"><p>ë¯¸ì…˜ì„ ìˆ˜í–‰í–ˆë‹¤ë©´ ì™„ë£Œ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!</p></div>
          <button class="btn-complete" onclick="completeMission(${m.id})">âœ¦ ë¯¸ì…˜ ì™„ë£Œ</button>`;
      }
    }

    card.innerHTML = `
      <div class="mission-header" onclick="toggleMission(${m.id})">
        <div class="mission-icon">${m.icon}</div>
        <div class="mission-info">
          <div class="mission-name">${nameHtml}</div>
          <div class="mission-desc">${m.desc}</div>
        </div>
        <div class="mission-status ${statusClass}">${statusLabel}</div>
      </div>
      ${expandContent ? `<div class="mission-expand show">${expandContent}</div>` : ''}`;
    container.appendChild(card);
  });
}

function updateChar(id) {
  const ta = document.getElementById(`textarea-${id}`);
  const c = document.getElementById(`char-${id}`);
  if (ta && c) c.textContent = ta.value.length;
}

// â”€â”€ ìë™ ë¯¸ì…˜ ìƒì„± â”€â”€
async function autoAddMission() {
  const btn = document.getElementById('btnAutoAdd');
  btn.classList.add('loading');
  btn.innerHTML = 'âœ¨ ìƒì„± ì¤‘...';
  btn.disabled = true;
  await new Promise(r => setTimeout(r, 700));
  const res = await fetch('/api/auto_mission', { method: 'POST' });
  const data = await res.json();
  btn.classList.remove('loading');
  btn.disabled = false;
  btn.innerHTML = '<span class="btn-add-plus">âœ¨</span> ìë™ ë¯¸ì…˜ ìƒì„±í•˜ê¸°';
  if (!data.success) {
    showToast('ë” ì´ìƒ ìë™ ìƒì„±í•  ë¯¸ì…˜ì´ ì—†ì–´ìš” ğŸ˜Š', '#c97b4c');
    return;
  }
  const m = data.mission;
  MISSIONS.push(m);
  state[String(m.id)] = { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
  updateProgress();
  renderMissions();
  showToast(`"${m.name}" ë¯¸ì…˜ì´ ìƒì„±ëì–´ìš”! ğŸ²`, '#7b6cd4');
  setTimeout(() => {
    const cards = document.querySelectorAll('.mission-card');
    if (cards.length) cards[cards.length - 1].scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 150);
}

// â”€â”€ ì§ì ‘ ë¯¸ì…˜ ì¶”ê°€ â”€â”€
const ICON_OPTIONS = ['â­','ğŸ”¥','ğŸ’ª','ğŸ§˜','ğŸ“–','ğŸ¨','ğŸµ','ğŸŒ¿','ğŸ€','ğŸ’¡','ğŸƒ','ğŸŒ™','ğŸŒˆ','â¤ï¸','ğŸ','ğŸµ','âœï¸','ğŸ§¹','ğŸ’»','ğŸ›'];
let selectedIcon = 'â­';

function initIconPicker() {
  const picker = document.getElementById('iconPicker');
  picker.innerHTML = '';
  ICON_OPTIONS.forEach(icon => {
    const btn = document.createElement('button');
    btn.className = 'icon-option' + (icon === selectedIcon ? ' selected' : '');
    btn.textContent = icon;
    btn.type = 'button';
    btn.onclick = () => {
      selectedIcon = icon;
      document.querySelectorAll('.icon-option').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
    };
    picker.appendChild(btn);
  });
}

function togglePlaceholderField(type) {
  document.getElementById('placeholderField').style.display = type === 'text' ? '' : 'none';
}

function openAddModal() {
  document.getElementById('newMissionName').value = '';
  document.getElementById('newMissionDesc').value = '';
  document.getElementById('newMissionPlaceholder').value = '';
  document.getElementById('newMissionType').value = 'text';
  selectedIcon = 'â­';
  initIconPicker();
  togglePlaceholderField('text');
  document.getElementById('addMissionModal').classList.add('show');
}

function closeAddModal() { document.getElementById('addMissionModal').classList.remove('show'); }

async function confirmAddMission() {
  const name = document.getElementById('newMissionName').value.trim();
  if (!name) { showToast('ë¯¸ì…˜ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš” âœï¸', '#c97b4c'); return; }
  const type = document.getElementById('newMissionType').value;
  const desc = document.getElementById('newMissionDesc').value.trim() || 'ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ë¯¸ì…˜';
  const placeholder = document.getElementById('newMissionPlaceholder').value.trim() || 'ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”...';
  const res = await fetch('/api/add_mission', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ icon: selectedIcon, name, desc, type, placeholder })
  });
  const data = await res.json();
  if (data.success) {
    const m = data.mission;
    MISSIONS.push(m);
    state[String(m.id)] = { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
    closeAddModal();
    updateProgress();
    renderMissions();
    showToast(`"${m.name}" ë¯¸ì…˜ì´ ì¶”ê°€ëì–´ìš”! âœ¨`, '#7b6cd4');
    setTimeout(() => {
      const cards = document.querySelectorAll('.mission-card');
      if (cards.length) cards[cards.length - 1].scrollIntoView({ behavior: 'smooth', block: 'center' });
    }, 150);
  }
}

function closeModal() { document.getElementById('completionModal').classList.remove('show'); }

// â”€â”€ 5ë¶„ íƒ€ì´ë¨¸ â”€â”€
const TIMER_TOTAL = 5 * 60;
const CIRCUMFERENCE = 2 * Math.PI * 35;
let timerLeft = TIMER_TOTAL;
let timerInterval = null;
let timerRunning = false;

function timerRender() {
  const m = String(Math.floor(timerLeft / 60)).padStart(2, '0');
  const s = String(timerLeft % 60).padStart(2, '0');
  const display = document.getElementById('timerDisplay');
  const ring = document.getElementById('timerRing');
  display.textContent = `${m}:${s}`;
  ring.style.strokeDashoffset = CIRCUMFERENCE * (1 - timerLeft / TIMER_TOTAL);
  if (timerLeft === 0) {
    display.className = 'timer-display done';
    ring.classList.add('done');
    showToast('â° 5ë¶„ ì™„ë£Œ! ìˆ˜ê³ í–ˆì–´ìš” ğŸ‰', '#4caf82');
    timerStop();
  } else if (timerRunning) {
    display.className = 'timer-display running';
    ring.classList.remove('done');
  } else {
    display.className = 'timer-display paused';
  }
}

function timerStart() {
  if (timerLeft === 0) return;
  timerRunning = true;
  document.getElementById('btnStart').style.display = 'none';
  document.getElementById('btnPause').style.display = '';
  timerInterval = setInterval(() => { timerLeft--; timerRender(); }, 1000);
}

function timerPause() {
  timerRunning = false;
  clearInterval(timerInterval);
  document.getElementById('btnStart').textContent = 'â–¶ ê³„ì†';
  document.getElementById('btnStart').style.display = '';
  document.getElementById('btnPause').style.display = 'none';
  timerRender();
}

function timerStop() {
  timerRunning = false;
  clearInterval(timerInterval);
  document.getElementById('btnStart').textContent = 'â–¶ ì‹œì‘';
  document.getElementById('btnStart').style.display = '';
  document.getElementById('btnPause').style.display = 'none';
}

function timerReset() {
  timerStop();
  timerLeft = TIMER_TOTAL;
  document.getElementById('btnStart').textContent = 'â–¶ ì‹œì‘';
  document.getElementById('timerRing').classList.remove('done');
  timerRender();
}

// â”€â”€ ì´ˆê¸°í™” â”€â”€
document.getElementById('timerRing').style.strokeDasharray = CIRCUMFERENCE;
document.getElementById('timerRing').style.strokeDashoffset = 0;

// stateì— expanded ì´ˆê¸°í™”
MISSIONS.forEach(m => {
  if (!state[String(m.id)]) state[String(m.id)] = { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
  state[String(m.id)].expanded = false;
});


function getDailyMissions() {
  const ALL_POOL = [{"icon": "ğŸŒ…", "name": "ì˜¤ëŠ˜ì˜ ì²« ê°ì • ê¸°ë¡", "desc": "ì•„ì¹¨ì— ëˆˆ ëœ¬ ìˆœê°„ì˜ ê°ì •ì„ ì†”ì§í•˜ê²Œ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ì•„ì¹¨ ê¸°ë¶„ì´ ì–´ë–¤ê°€ìš”?"}, {"icon": "ğŸ§ƒ", "name": "ìˆ˜ë¶„ ë³´ì¶© ì¸ì¦", "desc": "ë¬¼ í•œ ì” ë§ˆì‹œê³  ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸŒ³", "name": "ìì—° ì‚¬ì§„ ì°ê¸°", "desc": "ì˜¤ëŠ˜ ë³¸ í•˜ëŠ˜, ë‚˜ë¬´, ê½ƒ ë¬´ì—‡ì´ë“  ë‹´ì•„ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "ğŸ“", "name": "ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ í•œ ì¤„", "desc": "ì˜¤ëŠ˜ ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì‚¬ì‹¤ì„ ê¸°ë¡í•´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ì²˜ìŒ ì•Œê²Œ ëœ ê²ƒì€..."}, {"icon": "ğŸ§¸", "name": "ë‚˜ì—ê²Œ ì‘ì› ë©”ì‹œì§€", "desc": "ì§€ê¸ˆì˜ ë‚˜ì—ê²Œ ë”°ëœ»í•œ í•œë§ˆë””ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜í•˜ê³  ìˆì–´, ì™œëƒí•˜ë©´..."}, {"icon": "ğŸ§", "name": "ì§€ê¸ˆ ê¸°ë¶„ì— ë§ëŠ” ë…¸ë˜", "desc": "ì§€ê¸ˆ ë“£ê³  ì‹¶ì€ ê³¡ ì œëª©ê³¼ ì´ìœ ë¥¼ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì§€ê¸ˆ ê¸°ë¶„ì— ë”± ë§ëŠ” ë…¸ë˜ëŠ”..."}, {"icon": "ğŸš¶", "name": "10ë¶„ ì‚°ì±… ì¸ì¦", "desc": "ì ê¹ì´ë¼ë„ ë°–ì„ ê±·ê³  ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸ½ï¸", "name": "ì˜¤ëŠ˜ ë¨¹ì€ ê²ƒ ê¸°ë¡", "desc": "ì˜¤ëŠ˜ ê°€ì¥ ë§›ìˆì—ˆë˜ ìŒì‹ì„ ì‚¬ì§„ìœ¼ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "ğŸ’¬", "name": "ì†Œì¤‘í•œ ì‚¬ëŒì—ê²Œ ì—°ë½", "desc": "ì˜¤ëœë§Œì— ìƒê°ë‚œ ì‚¬ëŒì—ê²Œ ì•ˆë¶€ë¥¼ ì „í•´ë´¤ë‚˜ìš”?", "type": "check", "placeholder": ""}, {"icon": "ğŸŒ™", "name": "ì˜¤ëŠ˜ í•˜ë£¨ ì„¸ ì¤„ íšŒê³ ", "desc": "ì˜í•œ ê²ƒ, ì•„ì‰¬ìš´ ê²ƒ, ë‚´ì¼ í•  ê²ƒì„ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜í•œ ê²ƒ / ì•„ì‰¬ìš´ ê²ƒ / ë‚´ì¼ í•  ê²ƒ"}, {"icon": "ğŸ¯", "name": "ì˜¤ëŠ˜ì˜ ì§‘ì¤‘ ì‹œê°„ ì„ ì–¸", "desc": "ì˜¤ëŠ˜ ê°€ì¥ ì§‘ì¤‘í•˜ê³  ì‹¶ì€ ì¼ í•˜ë‚˜ë¥¼ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ë°˜ë“œì‹œ í•´ë‚¼ ê²ƒì€..."}, {"icon": "ğŸ–¼ï¸", "name": "ì˜¤ëŠ˜ì˜ ê³µê°„ ì‚¬ì§„", "desc": "ì§€ê¸ˆ ìˆëŠ” ê³µê°„ì„ ê·¸ëŒ€ë¡œ ì°ì–´ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "ğŸ¤²", "name": "ì˜¤ëŠ˜ì˜ ê°ì‚¬ í•œ ì¤„", "desc": "ì‘ë”ë¼ë„ ì˜¤ëŠ˜ ê°ì‚¬í•œ ê²ƒ í•˜ë‚˜ë¥¼ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ì‘ì§€ë§Œ ê°ì‚¬í–ˆë˜ ê²ƒì€..."}, {"icon": "ğŸ’¤", "name": "7ì‹œê°„ ìˆ˜ë©´ ë„ì „", "desc": "ì¶©ë¶„íˆ ì¤ë‹¤ë©´ ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸƒ", "name": "ì˜¤ëŠ˜ì˜ í–‰ìš´ ì¹´ë“œ", "desc": "1~100 ì‚¬ì´ì˜ í–‰ìš´ ë²ˆí˜¸ë¥¼ ë½‘ì•„ë³´ì„¸ìš”", "type": "random", "placeholder": ""}, {"icon": "ğŸŒ¿", "name": "ìŠ¤íŠ¸ë ˆì¹­ 5ë¶„", "desc": "ëª¸ì„ ì›€ì§ì´ê³  ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸ“–", "name": "ì±… í•œ í˜ì´ì§€ ì½ê¸°", "desc": "ì§§ë”ë¼ë„ ì˜¤ëŠ˜ ì½ì€ ë‚´ìš©ì„ ê¸°ë¡í•´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ì½ì€ ì±…ê³¼ ê¸°ì–µì— ë‚¨ëŠ” ë¬¸ì¥ì€..."}, {"icon": "ğŸ¨", "name": "ë‚™ì„œ ë˜ëŠ” ë“œë¡œì‰", "desc": "ë­”ê°€ë¥¼ ê·¸ë¦¬ê³  ì‚¬ì§„ìœ¼ë¡œ ì°ì–´ ë‚¨ê²¨ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "ğŸ ", "name": "ê³µê°„ ì •ë¦¬ ì¸ì¦", "desc": "ì±…ìƒì´ë“  ë°©ì´ë“  í•œ ê³³ì„ ì •ë¦¬í•˜ê³  ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸ“¸", "name": "ì§€ê¸ˆ ì´ ìˆœê°„ í¬ì°©", "desc": "ì§€ê¸ˆ ëˆˆì•ì— ë³´ì´ëŠ” ê²ƒì„ ì‚¬ì§„ìœ¼ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "â˜€ï¸", "name": "ì˜¤ëŠ˜ì˜ ë‚ ì”¨ ê°ìƒ", "desc": "ì˜¤ëŠ˜ ë‚ ì”¨ë¥¼ ë³´ë©° ëŠë‚€ ê°ì •ì„ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì£¼ëŠ” ëŠë‚Œì€..."}, {"icon": "ğŸ§ ", "name": "ì˜¤ëŠ˜ ê³ ë¯¼ í•´ê²°í•˜ê¸°", "desc": "ìš”ì¦˜ ê³ ë¯¼ ì¤‘ì¸ ê²ƒì„ ì¨ë³´ê³  í•´ê²°ì±…ì„ ì°¾ì•„ë³´ì„¸ìš”", "type": "text", "placeholder": "ê³ ë¯¼ / í•´ê²°ì±…"}, {"icon": "ğŸ’ƒ", "name": "ì˜¤ëŠ˜ì˜ ê¸°ë¶„ ì ìˆ˜", "desc": "ì˜¤ëŠ˜ ê¸°ë¶„ì„ 1~10ì ìœ¼ë¡œ ì ìˆ˜ ë§¤ê¸°ê³  ì´ìœ ë¥¼ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì ìˆ˜ / ì´ìœ "}, {"icon": "ğŸŒº", "name": "ì˜ˆìœ ê²ƒ ì°¾ê¸°", "desc": "ì˜¤ëŠ˜ ì£¼ë³€ì—ì„œ ì•„ë¦„ë‹¤ìš´ ê²ƒì„ ì‚¬ì§„ìœ¼ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”", "type": "photo", "placeholder": ""}, {"icon": "âœ¨", "name": "ì˜¤ëŠ˜ì˜ ì‘ì€ ì„±ê³µ", "desc": "ì˜¤ëŠ˜ ì´ë¤„ë‚¸ ì‘ì€ ì„±ì·¨ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ë‚´ê°€ í•´ë‚¸ ê²ƒì€..."}, {"icon": "ğŸ¬", "name": "ì¸ìƒ ê¹Šì€ ì¥ë©´ ê¸°ë¡", "desc": "ì˜¤ëŠ˜ ë³¸ ì˜ìƒì´ë‚˜ ì˜í™”ì˜ ì¸ìƒ ê¹Šì€ ì¥ë©´ì„ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì¥ë©´ê³¼ ê·¸ ì´ìœ ëŠ”..."}, {"icon": "ğŸ›ï¸", "name": "ì¼ì° ìê¸° ë„ì „", "desc": "ì˜¤ëŠ˜ì€ í‰ì†Œë³´ë‹¤ 30ë¶„ ì¼ì° ìë³´ê¸°!", "type": "check", "placeholder": ""}, {"icon": "ğŸ§Š", "name": "ëƒ‰ì¥ê³  ì •ë¦¬", "desc": "ëƒ‰ì¥ê³ ë¥¼ í•œ ë²ˆ ì •ë¦¬í•˜ê³  ì™„ë£Œ ì²´í¬!", "type": "check", "placeholder": ""}, {"icon": "ğŸ™", "name": "ê°ì‚¬ ë©”ì‹œì§€ ì‘ì„±", "desc": "ì˜¤ëŠ˜ ê°ì‚¬í•œ ì¼ 3ê°€ì§€ë¥¼ ì ì–´ë³´ì„¸ìš”", "type": "text", "placeholder": "ì˜¤ëŠ˜ ê°ì‚¬í–ˆë˜ ì¼ì€..."}, {"icon": "ğŸ’Œ", "name": "ì†Œì¤‘í•œ ì‚¬ëŒì—ê²Œ í¸ì§€", "desc": "ê·¸ë¦¬ìš´ ì‚¬ëŒì—ê²Œ ì§§ì€ í¸ì§€ë¥¼ ì¨ë³´ì„¸ìš”", "type": "text", "placeholder": "ë§ˆìŒì„ ë‹´ì•„ í¸ì§€ë¥¼ ì¨ë³´ì„¸ìš”..."}];
  const today = new Date();
  const seed = today.getFullYear() * 10000 + (today.getMonth()+1) * 100 + today.getDate();
  function seededRand(s) { let x = Math.sin(s) * 10000; return x - Math.floor(x); }
  const indices = [...Array(ALL_POOL.length).keys()];
  indices.sort((a, b) => seededRand(seed + a) - seededRand(seed + b));
  return indices.slice(0, 5).map((i, idx) => ({
    ...ALL_POOL[i], id: idx + 100, minLength: ALL_POOL[i].type === 'text' ? 5 : 0
  }));
}



// extras.jsì—ì„œ MISSIONS/state ë®ì–´ì”Œìš´ ê²½ìš° ë°˜ì˜
if (window.MISSIONS) MISSIONS = window.MISSIONS;
if (window.state) state = window.state;
// expanded ì´ˆê¸°í™”
MISSIONS.forEach(function(m) {
  if (!state[String(m.id)]) state[String(m.id)] = { completed: false, expanded: false, value: '', lucky: null, fileName: '' };
  state[String(m.id)].expanded = false;
});
timerRender();
renderMissions();
updateProgress();
</script>
<script src="/static/extras.js"></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js');
  });
}
</script>
</body>
</html>
