# MOMENT PICK — 배포 가이드
## GitHub + Render + 가비아 도메인 연결

---

## 📁 전체 흐름

```
내 컴퓨터 → GitHub 저장소 → Render 배포 → 가비아 도메인 연결
```

---

## STEP 1. GitHub 저장소 만들기

### 1-1. GitHub 계정 로그인
https://github.com 접속 후 로그인

### 1-2. 새 저장소 생성
1. 우측 상단 **+** 버튼 → **New repository** 클릭
2. 설정:
   - Repository name: `moment-pick`
   - Public 선택 (Render 무료 플랜은 Public 필요)
   - README 추가 체크 해제
3. **Create repository** 클릭

### 1-3. 로컬에서 코드 올리기
VS Code 터미널에서 `moment-pick-deploy` 폴더 안으로 이동 후:

```bash
git init
git add .
git commit -m "first commit: MOMENT PICK 초기 배포"
git branch -M main
git remote add origin https://github.com/내깃허브아이디/moment-pick.git
git push -u origin main
```

> ⚠️ `내깃허브아이디` 부분을 본인 GitHub 아이디로 바꿔주세요!

---

## STEP 2. Render에서 웹 서비스 배포하기

### 2-1. Render 계정 만들기
https://render.com 접속 → **GitHub으로 로그인** (편의상 GitHub 계정 연동 추천)

### 2-2. 새 Web Service 만들기
1. 대시보드에서 **New +** → **Web Service** 클릭
2. **Connect a repository** → `moment-pick` 저장소 선택
3. 아래 설정 입력:

| 항목 | 값 |
|------|-----|
| Name | moment-pick |
| Region | Singapore (한국과 가장 가까움) |
| Branch | main |
| Runtime | Python 3 |
| Build Command | `pip install -r requirements.txt` |
| Start Command | `gunicorn app:app` |
| Instance Type | **Free** |

4. **Create Web Service** 클릭

### 2-3. 배포 완료 확인
- 배포에 2~3분 소요
- 로그에 `Listening on http://0.0.0.0:10000` 뜨면 성공
- 자동으로 생성된 URL 확인: `https://moment-pick-xxxx.onrender.com`

---

## STEP 3. 가비아 도메인 연결하기

### 3-1. Render에서 커스텀 도메인 추가
1. Render 대시보드 → 내 서비스 클릭
2. 상단 탭에서 **Settings** → **Custom Domains** 섹션
3. **Add Custom Domain** 클릭
4. 도메인 입력: `yourdomain.com` (구매한 도메인)
5. Render가 아래 두 가지 정보를 보여줌 (복사해두기):

```
Type: CNAME
Name: www  (또는 @)
Value: moment-pick-xxxx.onrender.com
```

> 루트 도메인(`yourdomain.com`)은 CNAME 대신 A 레코드가 필요한 경우도 있음.
> Render는 루트 도메인에 **ALIAS** 또는 **ANAME** 레코드를 권장하지만
> 가비아는 이를 지원하지 않으므로 아래처럼 설정합니다.

---

### 3-2. 가비아 DNS 설정

1. https://www.gabia.com 로그인
2. **My가비아** → **도메인 관리** → 해당 도메인 클릭
3. **DNS 정보** 탭 → **DNS 관리** 클릭
4. 아래 레코드 추가:

**www 서브도메인 (www.yourdomain.com):**
```
타입:  CNAME
호스트: www
값:    moment-pick-xxxx.onrender.com.  ← 끝에 점(.) 붙이기
TTL:   600
```

**루트 도메인 (yourdomain.com) — A 레코드 방식:**
```
타입:  A
호스트: @
값:    216.24.57.1
TTL:   600
```
> 위 IP는 Render의 IP입니다. Render 공식 문서에서 최신 IP 확인 권장:
> https://render.com/docs/custom-domains

5. **저장** 클릭

---

### 3-3. DNS 전파 대기
- DNS 변경은 최대 **24~48시간** 걸릴 수 있음
- 보통은 **10~30분** 내에 적용됨
- 확인: https://dnschecker.org 에서 도메인 검색

---

### 3-4. Render에서 도메인 인증 확인
- Render 대시보드 → Custom Domains 탭
- 도메인 옆에 ✅ **Verified** 뜨면 완료!
- Render가 자동으로 **HTTPS(SSL)** 인증서도 발급해줌

---

## STEP 4. 코드 수정 후 재배포 방법

앞으로 코드를 수정하면 GitHub에 push만 하면 **자동으로 Render가 재배포**합니다:

```bash
git add .
git commit -m "수정 내용 설명"
git push
```

---

## ✅ 최종 체크리스트

- [ ] GitHub 저장소에 코드 push 완료
- [ ] Render Web Service 생성 및 배포 성공
- [ ] `https://moment-pick-xxxx.onrender.com` 에서 앱 확인
- [ ] 가비아 DNS CNAME / A 레코드 추가
- [ ] Render Custom Domain 인증 완료 (✅ Verified)
- [ ] `https://yourdomain.com` 에서 앱 접속 확인

---

## ⚠️ 자주 묻는 질문

**Q. Render 무료 플랜의 단점은?**
> 15분 동안 접속이 없으면 서버가 잠자기(Sleep) 상태가 됩니다.
> 다시 접속하면 30~60초 로딩 후 깨어납니다.
> 유료 플랜($7/월)으로 업그레이드하면 항상 켜져 있습니다.

**Q. 가비아에서 ALIAS/ANAME이 없는데요?**
> 가비아는 ALIAS를 지원하지 않습니다.
> www 서브도메인(CNAME)을 메인으로 사용하거나
> A 레코드에 Render IP를 직접 입력하세요.

**Q. HTTPS가 자동으로 되나요?**
> 네! Render가 Let's Encrypt 인증서를 자동 발급합니다.
> 도메인 인증 후 수 분 내에 https:// 로 접속 가능합니다.
